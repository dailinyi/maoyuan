<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, minimal-ui" />
    <title></title>
    [#include "../include/库.html"/]
</head>
<script type="application/javascript">
    $(function() {
        $("#tableForm").validate();
        [#if success??]
        [#if success]
        alert("修改成功!");
        [/#if]
        [/#if]
    })
    function submitForm(){
        $('#tableForm').submit();
    }


</script>
<body>
<form id="tableForm" action="profile.jspx" enctype="multipart/form-data" method="post">
<div class="register-bg my-bg">
    <div>个人中心</div>
    <div class="player-head">
        <div><a href="#" id="lk_upload_photo"><input type="file" id="file_upload_photo" name="file_upload_photo" style="position:absolute; right:0; top:0; font-size:100px; opacity:0; filter:alpha(opacity=0);" onchange="preImg(this.id,'imgPre');"/><img id="imgPre" src="/${res}/img/tx.jpg" width="120" height="120"></a></div>
        <div class="photo-icon"></div>
    </div>
</div>
<div class="head-height"></div>
<div class="card-num">会员卡号：${user.username}</div>
<div class="main-box">
    <div class="player-info">
        <ul>
            <li>
                <p class="fL">我的二维码名片</p>
                <p class="fR"><a href="qr.jspx">&gt;</a></p>
            </li>
            <li>
                <p class="fL">姓名</p>
                <p class="fR">
                    <input type="text" name="realname" placeholder="请输入" value="${user.realname!}">
                </p>
            </li>
            <li>
                <p class="fL">性别</p>
                <p class="fR">
                    <select dir="rtl"  name="gender">
                        <option value="true" [#if user.gender?? && user.gender ] selected [/#if]>男</option>
                        <option value="false" [#if user.gender?? && !user.gender ] selected [/#if]>女</option>
                    </select>
                </p>
            </li>
            <li>
                <p class="fL">手机号码</p>
                <p class="fR">
                    <input type="text" placeholder="请输入" name="mobile" value="${user.mobile!}">
                </p>
            </li>
            <li>
                <p class="fL">身份证号</p>
                <p class="fR">
                    <input type="text" placeholder="请输入" name="msn" value="${user.msn!}">
                </p>
            </li>
            <li>
                <p class="fL">出生日期</p>
                <p class="fR">
                    <input type="date" placeholder="请输入" name="birthday" value="${(user.birthday?string('yyyy-MM-dd'))!}">
                </p>
            </li>
            <li>
                <p class="fL">个人邮箱</p>
                <p class="fR">
                    <input type="text" placeholder="请输入" name="email" value="${user.email!}">
                </p>
            </li>
            <li>
                <p class="fL">修改密码</p>
                <p class="fR"><a href="pwd.jspx">&gt;</a></p>
            </li>
        </ul>
    </div>
    <div class="mT20"><a class="btn-submit" href="###" onclick="submitForm()">确认修改个人信息</a></div>
</div>
</form>

<script type="text/javascript">
    function preImg(sourceId, targetId) {
        if (typeof FileReader === 'undefined') {
            alert('Your browser does not support FileReader...');
            return;
        }
        var reader = new FileReader();

        reader.onload = function (e) {
            var oWidth = 0;
            var oHeigth = 0;
            var nWidth = 0;
            var nHeigth = 0;
            var ml = 0;
            var mt = 0;
            var img = document.getElementById(targetId);
            img.src = this.result;
            oWidth = img.naturalWidth;
            oHeigth = img.naturalHeight;
            if (oWidth >= oHeigth) {
                nHeigth = 120;
                nWidth = oWidth * nHeigth / oHeigth;
                ml = (nWidth - 120) / 2;

            }
            else {
                nWidth = 120;
                nHeigth = oHeigth * nWidth / oWidth;
                mt = (nHeigth - 120) / 2;
            }
            img.removeAttribute("width");
            img.removeAttribute("height");
            img.style.width = nWidth + "px";
            img.style.height = nHeigth + "px";
            img.style.marginLeft = -ml + "px";
            img.style.marginTop = -mt + "px";
        }
        reader.readAsDataURL(document.getElementById(sourceId).files[0]);

    }
</script>
</body>
</html>
